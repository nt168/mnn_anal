# 生成长度参数优化预实验（简化版）
**版本：Simple Method v1.0**

## 实验目标
通过简化的三步筛选法，确定最优生成长度（32/64/128）

## 1. 数据采集规范

### 1.1 核心测量指标
- **tg数据**：LLM_bench直接测量的生成速度（token/秒）
- **tg的CV**：tg数据的变异系数，衡量生成速度的相对波动程度
- **物理意义**：tg的CV越低，说明该实验配置下的推理性能越稳定
- **优势**：直接使用测量值，避免时间转换引入的误差

### 1.2 数据采集方法
- **测量对象**：直接使用LLM_bench输出的tg值（生成速度）
- **数据处理**：每组重复10次，记录tg值和标准差，计算tg的CV
- **计算公式**：`tg_CV = std(tg数据) / mean(tg数据)`
- **实验分组**：3个提示词区间 × 3个生成长度 × 10次重复

### 1.3 实验分组示例
```
生成长度32：
- 组1：生成长度32 + 提示词区间[8-16]
  → 测试提示词长度：8(5次) + 16(5次)
  → 得到10个tg数据 → 计算tg_CV_8-16

- 组2：生成长度32 + 提示词区间[32-48]
  → 测试提示词长度：32(5次) + 48(5次)
  → 得到10个tg数据 → 计算tg_CV_32-48

- 组3：生成长度32 + 提示词区间[64-128]
  → 测试提示词长度：64(5次) + 128(5次)
  → 得到10个tg数据 → 计算tg_CV_64-128
```

## 2. 简化三步筛选法

### 第1步：稳定性检查
- **标准**：所有区间的tg的CV ≤ 15%
- **物理意义**：测量工具本身足够稳定
- **筛选逻辑**：任一生成长度如果有一个区间CV > 15%，直接淘汰

### 第2步：区分能力检查
- **标准**：长短区间差异 ≥ 20%
- **计算方式**：`(tg_CV_短区间 - tg_CV_长区间) / tg_CV_短区间 ≥ 20%`
- **物理意义**：能够区分不同提示词长度的影响
- **筛选逻辑**：无法达到20%差异的生成长度淘汰

### 第3步：效率优化选择
- **标准**：实际测试时间最短
- **计算方式**：对所有候选生成长度，实际测试时间 = 生成长度 ÷ 平均tg值
- **物理意义**：完成基准测试的实际时间成本
- **选择逻辑**：在前两步筛选通过的基础上，选择测试时间最短的

## 3. 执行流程

### 3.1 实验执行顺序
1. 对生成长度32、64、128分别完成完整测试
2. 记录每个生成长度的3个区间的tg的CV数据
3. 计算平均tg值用于效率评估

### 3.2 筛选决策过程
```
稳 定 性 检 查 → 区分能力检查 → 效率优化选择
     ↓              ↓              ↓
  CV ≤ 15%?    差异 ≥ 20%?    时间最短?
     ↓              ↓              ↓
   淘汰/通过      淘汰/通过      最终选择
```

## 4. 预期结果示例

### 4.1 数据记录表
| 生成长度 | CV_短区间 | CV_中区间 | CV_长区间 | 平均tg值 | 最大CV | 长短差异 | 测试时间 |
|---------|----------|----------|----------|---------|-------|---------|---------|
| 32      | X%       | Y%       | Z%       | T₁      | M₁%   | Diff₁%  | Time₁   |
| 64      | A%       | B%       | C%       | T₂      | M₂%   | Diff₂%  | Time₂   |
| 128     | P%       | Q%       | R%       | T₃      | M₃%   | Diff₃%  | Time₃   |

### 4.2 决策记录
```
第1步：稳定性检查
✓ 32通过（最大CV = M₁% ≤ 15%）
✓ 64通过（最大CV = M₂% ≤ 15%）
✗ 128淘汰（最大CV = M₃% > 15%）

第2步：区分能力检查
✓ 32通过（长短差异 = Diff₁% ≥ 20%）
✓ 64通过（长短差异 = Diff₂% ≥ 20%）

第3步：效率优化选择
32测试时间 = Time₁秒
64测试时间 = Time₂秒
选择64（测试时间更短）

最终决策：选择生成长度64
```

## 5. 关键优势

### 5.1 操作简单
- 无需复杂数学计算
- 直观的筛选逻辑
- 易于实施和判断

### 5.2 目标明确
- 每步筛选目标清晰
- 物理意义容易理解
- 决策过程透明

### 5.3 实用性强
- 基于实际测试需求
- 考虑时间成本因素
- 适合工程实践

---

**文件说明**：本方案采用简化的三步筛选法，强调实用性和可操作性。如需更复杂的科学论证，请参考同目录下的备选方案。

**适用场景**：常规基准测试参数优化，工程实践应用
**复杂度评估**：⭐⭐（低）