# 初测结果2数据库测试结果总结
## 5个核心参数的性能基准测试体系

本次基准测试的核心目标是为端侧LLM推理的5个关键参数选择提供量化依据：

1. **threads (t参数)** - 线程数优化
2. **repeat (rep参数)** - 重复测试次数选择
3. **precision** - 精度模式选择
4. **mmap** - 内存映射开关选择
5. **dynamicOption** - 动态优化级别选择

---

## 一、threads参数测试 (任务2,3,4)

### 1.1 测试目标
**分析不同线程数对MNN LLM推理性能的影响规律，为端侧设备线程调度提供优化依据**

### 1.2 涉及Suite
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| pn_grid_t1 | 任务2 | hunyuan_05b_1t | 6 | 单线程基线 |
| pn_grid_t2 | 任务3 | hunyuan_05b_2t | 6 | 双线程性能 |
| pn_grid_t6 | 任务4 | hunyuan_05b_6t | 6 | 六线程扩展性 |

### 1.3 参数设计
**固定参数**:
```json
{
  "kv_cache": "false",
  "precision": 2,
  "mmap": "0",
  "dynamicOption": 0
}
```

**自变量**:
- **threads**: [1, 2, 6] - 主要测试变量
- **n_prompt**: [192, 384, 512] - 预填充长度变化
- **n_gen**: [64, 128] - 生成长度变化

**测试矩阵**: 3线程数 × 3预填充长度 × 2生成长度 = 18种组合，共36个结果条目

---

## 二、repeat参数测试 (任务8)

### 2.1 测试目标
**确定合理的测试重复次数，在保证结果可信度的前提下最大化测试效率**

### 2.2 涉及Suite
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| rep_p_grid_t1 | 任务8 | hunyuan_05b_1t | 12 | 重复次数稳定性验证 |

### 2.3 参数设计
**固定参数**:
```json
{
  "threads": 1,
  "kv_cache": "false",
  "precision": 2,
  "mmap": "0",
  "dynamicOption": 0
}
```

**自变量**:
- **repeat**: [2, 3, 4, 5] - 主要测试变量
- **n_prompt**: [192, 384, 512] - 不同预填充长度下的稳定性
- **n_gen**: 64 (固定)

**测试重点**: 评估重复次数对结果标准差的影响，寻找可信度与效率的平衡点

**测试矩阵**: 4重复次数 × 3预填充长度 = 12种组合，共24个结果条目

---

## 三、precision参数测试 (任务9)

### 3.1 测试目标
**量化不同精度模式对推理性能的影响程度，为性能-精度平衡提供选择依据**

### 3.2 涉及Suite
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| precision_effect_t1 | 任务9 | hunyuan_05b | 3 | 精度模式性能影响 |
| precision_effect_t1 | 任务9 | qwen3_06b | 3 | 跨模型对比验证 |

### 3.3 参数设计
**固定参数**:
```json
{
  "threads": 1,
  "kv_cache": "false",
  "mmap": "0",
  "dynamicOption": 0,
  "n_prompt": 512,
  "n_gen": 128
}
```

**自变量**:
- **precision**: [0, 1, 2] - 主要测试变量
  - 0 = Normal 精度
  - 1 = High 精度
  - 2 = Low 精度

**测试矩阵**: 3精度模式 × 2模型 = 6种组合，共12个结果条目

---

## 四、mmap参数测试 (任务9)

### 4.1 测试目标
**评估内存映射技术对大模型加载和推理的实际性能增益**

### 4.2 涉及Suite
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| mmap_effect_t1 | 任务9 | hunyuan_05b | 2 | 内存映射开关影响 |
| mmap_effect_t1 | 任务9 | qwen3_06b | 2 | 跨模型对比验证 |

### 4.3 参数设计
**固定参数**:
```json
{
  "threads": 1,
  "precision": 0,
  "kv_cache": "false",
  "dynamicOption": 0,
  "n_prompt": 512,
  "n_gen": 128
}
```

**自变量**:
- **mmap**: ["0", "1"] - 主要测试变量
  - "0": 关闭内存映射
  - "1": 启用内存映射

**测试矩阵**: 2mmap设置 × 2模型 = 4种组合，共8个结果条目

---

## 五、dynamicOption参数测试 (任务9)

### 5.1 测试目标
**系统评估MNN动态优化策略的9个级别对推理性能的影响梯度**

### 5.2 涉及Suite
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| dynamic_option_effect_t1 | 任务9 | hunyuan_05b | 9 | 动态优化级别扫描 |
| dynamic_option_effect_t1 | 任务9 | qwen3_06b | 9 | 跨模型对比验证 |

### 5.3 参数设计
**固定参数**:
```json
{
  "threads": 1,
  "precision": 0,
  "kv_cache": "false",
  "mmap": "0",
  "n_prompt": 512,
  "n_gen": 128
}
```

**自变量**:
- **dynamicOption**: [0, 1, 2, 3, 4, 5, 6, 7, 8] - 主要测试变量
  - 0-8 代表MNN的9个动态优化级别

**测试矩阵**: 9优化级别 × 2模型 = 18种组合，共36个结果条目

---

## 六、测试体系设计总结

### 6.1 参数覆盖完整性
| 参数 | 测试任务 | 自变量范围 | 固定参数设计 | 结果条目数 |
|------|----------|------------|--------------|------------|
| threads | 2,3,4 | [1,2,6] | kv_cache=false, precision=2, mmap="0", dynamicOption=0 | 36 |
| repeat | 8 | [2,3,4,5] | threads=1, kv_cache=false, precision=2, mmap="0", dynamicOption=0 | 24 |
| precision | 9 | [0,1,2] | threads=1, kv_cache=false, mmap="0", dynamicOption=0, n_prompt=512, n_gen=128 | 12 |
| mmap | 9 | ["0","1"] | threads=1, precision=0, kv_cache=false, dynamicOption=0, n_prompt=512, n_gen=128 | 8 |
| dynamicOption | 9 | [0-8] | threads=1, precision=0, kv_cache=false, mmap="0", n_prompt=512, n_gen=128 | 36 |

### 6.2 设计原则
1. **单变量控制**: 每个参数测试固定其他参数，确保结果的可比性
2. **模型对比**: 后3个参数包含hunyuan_05b和qwen3_06b的跨模型验证
3. **实用导向**: 固定参数选择贴近实际使用场景
4. **完整性覆盖**: 每个参数的常用取值都有充分测试

### 6.3 数据质量
- **总任务数**: 5个COMPLETED任务
- **总Suite数**: 10个测试套件
- **总测试用例**: 58个
- **总结果条目**: 116个
- **数据完整性**: 100% (所有测试都有完整结果)

