# 初测结果1数据库测试结果总结
## P/N组合性能基准测试体系

本次基准测试是EAO项目的初始验证测试，专注于建立P/N（预填充长度/生成长度）组合对端侧LLM推理性能的基础数学模型。

---

## 一、测试目标

**建立预填充长度(n_prompt)和生成长度(n_gen)组合与推理性能的数学关系模型，为后续参数化测试提供基线参考**

---

## 二、测试设计概览

### 2.1 涉及任务
| 任务ID | 任务名称 | 执行时间 | 状态 |
|--------|----------|---------|------|
| 1 | mnn_llm_t1_c2_pn_sweep_20251120_090711 | 2025-11-20 01:07:11 - 07:49:08 | completed |

### 2.2 测试Suite配置
| Suite名称 | 包含任务 | 模型 | 测试用例数 | 测试目标 |
|------------|----------|------|------------|----------|
| pn_grid_t1_c2_kvfalse_mmap0_dyo0 | 任务1 | qwen3_06b | 128 | Qwen3-6B P/N组合扫描 |
| pn_grid_t1_c2_kvfalse_mmap0_dyo0 | 任务1 | hunyuan_05b | 128 | Hunyuan-05B P/N组合扫描 |

### 2.3 固定参数设计
```json
{
  "threads": 1,           // 单线程执行
  "precision": 2,         // Low精度模式
  "kv_cache": "false",   // 关闭KV缓存
  "mmap": "0",           // 关闭内存映射
  "dynamicOption": 0     // 动态优化级别0
}
```

### 2.4 自变量扫描范围
- **n_prompt**: [64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024] (16个值)
- **n_gen**: [32, 64, 96, 128, 160, 192, 224, 256] (8个值)

**测试矩阵**: 16预填充长度 × 8生成长度 = 128种组合/模型，共256个测试用例

---

## 三、性能指标体系

### 3.1 核心性能指标
| 指标类型 | 指标含义 | 计算方式 | 单位 |
|----------|----------|----------|------|
| pp | Prefill阶段吞吐量 | token/秒 | token/s |
| tg | Decode阶段吞吐量 | token/秒 | token/s |

### 3.2 测试重复次数
- **repeat**: 3次 (全局配置)
- **每个P/N组合**: 3次独立测试取平均和标准差

---

## 四、测试范围覆盖性

### 4.1 模型覆盖
- **qwen3_06b**: Qwen3 6亿参数模型
- **hunyuan_05b**: 混元5亿参数model

### 4.2 序列长度范围
| 长度类型 | 最小值 | 最大值 | 采样点数 | 覆盖策略 |
|----------|--------|--------|----------|----------|
| n_prompt | 64 | 1024 | 16 | 等间隔采样 |
| n_gen | 32 | 256 | 8 | 等间隔采样 |

### 4.3 性能场景覆盖
- **短文本场景**: 64-256 tokens (常见对话)
- **中等文本场景**: 256-512 tokens (文档处理)
- **长文本场景**: 512-1024 tokens (长文档)
- **混合比例**: 覆盖不同P/N比例关系

---

## 五、数据质量评估

### 5.1 数据完整性
- **总测试用例**: 256个
- **成功率**: 100% (256/256)
- **失败测试用例**: 0个
- **总结果条目**: 512个 (每个用例pp+tg两个指标)

### 5.2 数据稳定性
- **测试重复次数**: 3次/用例
- **标准差统计**: 每个结果包含mean和std
- **稳定性评估**: 成功率100%表明测试环境稳定

### 5.3 数据覆盖度
- **P/N组合完整**: 16×8=128组合 × 2模型 = 256用例，全部完成
- **指标完整性**: pp(预填充)和tg(生成)两个核心指标全覆盖
- **跨模型验证**: 两个不同规模模型的性能规律对比

---

## 六、测试设计特点分析

### 6.1 相对于后续测试体系的局限性
1. **参数控制**: 未测试threads、repeat等参数影响
2. **测试深度**: 固定配置下的扫描，缺乏参数交互分析
3. **标准化程度**: 早期测试，标准化流程尚未建立
4. **分析工具**: 分析程序相对简单，可视化能力有限

### 6.2 价值与意义
1. **基线建立**: 为后续5参数体系提供性能基线
2. **基础模型**: 建立P/N组合的基础数学关系
3. **跨模型验证**: 验证不同模型在相同配置下的性能特征
4. **稳定性验证**: 验证测试环境的稳定性和可靠性

### 6.3 数据特点
- **密度高**: 256个测试用例，覆盖密度较高
- **范围广**: P/N范围从短到长全覆盖
- **真实性强**: 实际实用场景的参数范围

---

## 七、测试结论与建议

### 7.1 测试成果
- ✅ **成功建立P/N性能基准模型**
- ✅ **验证测试环境稳定性**
- ✅ **获得跨模型性能对比数据**
- ✅ **为后续参数体系奠定基础**

### 7.2 对后续测试的指导意义
1. **P/N范围**: 验证了64-1024/32-256的实用性范围
2. **固定参数**: 为threads=1,precision=2等配置提供性能基线
3. **测试密度**: 16×8的扫描密度足够建立准确模型
4. **跨模型模式**: 验证了多模型对比的价值

### 7.3 数据使用建议
- **基准参考**: 作为后续参数性能提升的baseline
- **模型验证**: 用于验证新模型的性能合理性
- **趋势分析**: P/N关系模型的建立基础
- **配置指导**: 为实用场景提供P/N组合选择依据

---

## 八、技术规格总结

### 8.1 测试执行信息
- **执行环境**: Linux (任务set 1)
- **测试时长**: ~6.5小时
- **平均单用例时间**: ~1.5分钟
- **重复次数**: 3次

### 8.2 配置规格说明
| 配置项 | 值 | 说明 |
|--------|----|----- |
| threads | 1 | 单线程，排除线程性能干扰 |
| precision | 2 | Low精度，偏向性能 |
| kv_cache | false | 关闭KV缓存，测试原始推理能力 |
| mmap | "0" | 关闭内存映射，测试基础性能 |
| dynamicOption | 0 | 最低动态优化，测试基础性能 |


**最后更新**: 2025年11月20日
**测试版本**: EAO初测阶段 T1测试